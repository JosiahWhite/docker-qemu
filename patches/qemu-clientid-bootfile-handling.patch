diff --git a/slirp/src/bootp.c b/slirp/src/bootp.c
index b208e3b..b118299 100644
--- a/slirp/src/bootp.c
+++ b/slirp/src/bootp.c
@@ -94,7 +94,7 @@ static BOOTPClient *find_addr(Slirp *slirp, struct in_addr *paddr,
 }
 
 static void dhcp_decode(const struct bootp_t *bp, int *pmsg_type,
-                        struct in_addr *preq_addr)
+                        struct in_addr *preq_addr, char *classid)
 {
     const uint8_t *p, *p_end;
     int len, tag;
@@ -133,6 +133,9 @@ static void dhcp_decode(const struct bootp_t *bp, int *pmsg_type,
                     memcpy(&(preq_addr->s_addr), p, 4);
                 }
                 break;
+            case RFC2132_CLASS_ID:
+                snprintf(classid, 128, "%.*s", len, p);
+                break;
             default:
                 break;
             }
@@ -156,9 +159,10 @@ static void bootp_reply(Slirp *slirp, const struct bootp_t *bp)
     uint8_t *q;
     uint8_t *end;
     uint8_t client_ethaddr[ETH_ALEN];
+    char client_classid[128];
 
     /* extract exact DHCP msg type */
-    dhcp_decode(bp, &dhcp_msg_type, &preq_addr);
+    dhcp_decode(bp, &dhcp_msg_type, &preq_addr, (char*)&client_classid);
     DPRINTF("bootp packet op=%d msgtype=%d", bp->bp_op, dhcp_msg_type);
     if (preq_addr.s_addr != htonl(0L))
         DPRINTF(" req_addr=%08" PRIx32 "\n", ntohl(preq_addr.s_addr));
@@ -256,9 +260,15 @@ static void bootp_reply(Slirp *slirp, const struct bootp_t *bp)
             *q++ = DHCPACK;
         }
 
-        if (slirp->bootp_filename)
-            snprintf((char *)rbp->bp_file, sizeof(rbp->bp_file), "%s",
-                     slirp->bootp_filename);
+        if (slirp->bootp_filename) {
+            if (!strcmp("NetBSD:i386:libsa", client_classid)) {
+                snprintf((char *)rbp->bp_file, sizeof(rbp->bp_file), "%s",
+                         "tftp://netbsd.gz" );
+            } else {
+                snprintf((char *)rbp->bp_file, sizeof(rbp->bp_file), "%s",
+                         slirp->bootp_filename);
+            }
+        }
 
         *q++ = RFC2132_SRV_ID;
         *q++ = 4;
diff --git a/slirp/src/bootp.h b/slirp/src/bootp.h
index d881ad6..07d4acc 100644
--- a/slirp/src/bootp.h
+++ b/slirp/src/bootp.h
@@ -71,6 +71,7 @@
 #define RFC2132_MAX_SIZE	57
 #define RFC2132_RENEWAL_TIME    58
 #define RFC2132_REBIND_TIME     59
+#define RFC2132_CLASS_ID        60
 #define RFC2132_TFTP_SERVER_NAME 66
 
 #define DHCPDISCOVER		1
